<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Autenticaci√≥n - EcoCampusCR</title>
  
  <link rel="stylesheet" href="css/sky.css">
  
  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  
  <script>
    tailwind.config = {
      darkMode: 'class'
    }
  </script>
  
  <style>
    /* Comportamiento de formularios activos */
    .form-section {
      display: none;
    }
    
    .form-section.active {
      display: block;
    }
    
    /* Mensajes de error */
    .error-message {
      display: none;
    }
    
    .error-message.show {
      display: block;
    }
    
    /* Mensaje de √©xito y user info */
    .success-message,
    .user-info {
      display: none;
    }
    
    .success-message.show,
    .user-info.show {
      display: block;
    }
  </style>
</head>
<body class="bg-white text-slate-900 dark:bg-slate-950 dark:text-slate-100 min-h-screen flex items-center justify-center p-4 relative overflow-hidden">

<!-- Fondos animados -->
<div class="sky-layer sky-day dark:hidden">
  <div class="cloud large" style="top: 10%; left: -10%; animation-delay: 0s;"></div>
  <div class="cloud medium" style="top: 25%; left: 40%; animation-delay: 8s;"></div>
  <div class="cloud small" style="top: 50%; left: 10%; animation-delay: 15s;"></div>
  <div class="cloud medium" style="top: 65%; left: 70%; animation-delay: 22s;"></div>
</div>

<div class="sky-layer sky-night hidden dark:block">
  <span class="star" style="top: 10%; left: 20%; animation-delay: 0s;"></span>
  <span class="star" style="top: 18%; left: 70%; animation-delay: 1s;"></span>
  <span class="star" style="top: 35%; left: 40%; animation-delay: 2.5s;"></span>
  <span class="star" style="top: 55%; left: 15%; animation-delay: 1.8s;"></span>
  <span class="star" style="top: 65%; left: 75%; animation-delay: 3.2s;"></span>
  <span class="star" style="top: 80%; left: 50%; animation-delay: 0.7s;"></span>
  
  <div class="shooting-star" style="top: 25%; left: 5%; animation-delay: 0s;"></div>
  <div class="shooting-star" style="top: 60%; left: -10%; animation-delay: 2.5s;"></div>
</div>

<!-- Contenedor principal -->
<div class="w-full max-w-md mx-4 relative z-10">
  
  <!-- Header con logo y bot√≥n de tema -->
  <div class="flex items-center justify-between mb-6">
    <div class="flex items-center gap-2">
      <div class="h-10 w-10 rounded-full bg-emerald-500/90 flex items-center justify-center text-slate-950 font-bold text-xl">
        ‚ôªÔ∏è
      </div>
      <div>
        <h1 class="text-xl font-bold text-emerald-700 dark:text-emerald-100">
          EcoCampus<span class="text-emerald-500">CR</span>
        </h1>
        <p class="text-xs text-emerald-700/80 dark:text-emerald-200/80">
          Gesti√≥n de Residuos Gamificada
        </p>
      </div>
    </div>

    <!-- Bot√≥n de tema -->
    <button id="theme-toggle" class="p-2 rounded-full border border-slate-300 dark:border-slate-600 hover:bg-slate-100 dark:hover:bg-slate-800 transition">
      <span id="theme-toggle-light" class="hidden text-xl">‚òÄÔ∏è</span>
      <span id="theme-toggle-dark" class="text-xl">üåô</span>
    </button>
  </div>

  <!-- Tarjeta de autenticaci√≥n -->
  <div class="bg-white/90 dark:bg-slate-900/80 border border-slate-200 dark:border-emerald-800/60 rounded-2xl shadow-2xl overflow-hidden backdrop-blur-sm">
    
    <!-- Botones de alternancia -->
    <div class="grid grid-cols-2 gap-0 border-b border-slate-200 dark:border-emerald-800/60">
      <button 
        id="btnLogin" 
        class="btn-toggle py-4 text-sm font-semibold transition-all bg-emerald-500 text-white"
      >
        Iniciar Sesi√≥n
      </button>
      <button 
        id="btnRegister" 
        class="btn-toggle py-4 text-sm font-semibold transition-all bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-400 hover:bg-slate-200 dark:hover:bg-slate-700"
      >
        Registrarse
      </button>
    </div>

    <!-- Contenedor de formularios -->
    <div class="p-6">
      
      <!-- Mensaje de √©xito -->
      <div id="successMessage" class="success-message mb-4 p-4 rounded-lg bg-emerald-100 dark:bg-emerald-900/30 border border-emerald-500 text-emerald-700 dark:text-emerald-300 text-sm">
      </div>

      <!-- FORMULARIO DE LOGIN -->
      <form id="loginForm" class="form-section active space-y-4">
        <div>
          <h2 class="text-lg font-semibold text-emerald-800 dark:text-emerald-100 mb-1">
            Bienvenido/a de vuelta
          </h2>
          <p class="text-xs text-emerald-700/80 dark:text-emerald-200/80 mb-4">
            Ingresa tus datos para acceder a tu cuenta
          </p>
        </div>

        <div>
          <label for="loginCedula" class="block text-xs font-semibold mb-2 text-emerald-800 dark:text-emerald-200">
            C√©dula *
          </label>
          <input 
            type="text" 
            id="loginCedula" 
            placeholder="Ej: 123456789" 
            required
            class="w-full px-4 py-3 rounded-lg bg-slate-50 dark:bg-slate-950/80 border border-slate-300 dark:border-slate-700 text-sm focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition"
          />
          <span id="loginCedulaError" class="error-message text-red-500 text-xs mt-1"></span>
        </div>

        <div>
          <label for="loginPassword" class="block text-xs font-semibold mb-2 text-emerald-800 dark:text-emerald-200">
            Contrase√±a *
          </label>
          <input 
            type="password" 
            id="loginPassword" 
            placeholder="Tu contrase√±a" 
            required
            class="w-full px-4 py-3 rounded-lg bg-slate-50 dark:bg-slate-950/80 border border-slate-300 dark:border-slate-700 text-sm focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition"
          />
          <span id="loginPasswordError" class="error-message text-red-500 text-xs mt-1"></span>
        </div>

        <button 
          type="submit" 
          class="w-full py-3 rounded-full bg-emerald-500 text-slate-950 text-sm font-bold hover:bg-emerald-400 transition shadow-lg shadow-emerald-500/40 hover:transform hover:-translate-y-0.5"
        >
          Iniciar Sesi√≥n
        </button>

        <p class="text-xs text-center text-emerald-700/80 dark:text-emerald-200/70">
          ¬øNo tienes cuenta? <button type="button" onclick="document.getElementById('btnRegister').click()" class="text-emerald-600 dark:text-emerald-400 font-semibold hover:underline">Reg√≠strate aqu√≠</button>
        </p>
      </form>

      <!-- FORMULARIO DE REGISTRO -->
      <form id="registerForm" class="form-section space-y-4">
        <div>
          <h2 class="text-lg font-semibold text-emerald-800 dark:text-emerald-100 mb-1">
            Crear cuenta nueva
          </h2>
          <p class="text-xs text-emerald-700/80 dark:text-emerald-200/80 mb-4">
            Completa tus datos para registrarte en la plataforma
          </p>
        </div>

        <div>
          <label for="regNombre" class="block text-xs font-semibold mb-2 text-emerald-800 dark:text-emerald-200">
            Nombre Completo *
          </label>
          <input 
            type="text" 
            id="regNombre" 
            placeholder="Tu nombre completo" 
            required
            class="w-full px-4 py-3 rounded-lg bg-slate-50 dark:bg-slate-950/80 border border-slate-300 dark:border-slate-700 text-sm focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition"
          />
          <span id="regNombreError" class="error-message text-red-500 text-xs mt-1"></span>
        </div>

        <div>
          <label for="regCorreo" class="block text-xs font-semibold mb-2 text-emerald-800 dark:text-emerald-200">
            Correo Institucional *
          </label>
          <input 
            type="email" 
            id="regCorreo" 
            placeholder="tu@utn.ac.cr" 
            required
            class="w-full px-4 py-3 rounded-lg bg-slate-50 dark:bg-slate-950/80 border border-slate-300 dark:border-slate-700 text-sm focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition"
          />
          <span id="regCorreoError" class="error-message text-red-500 text-xs mt-1"></span>
        </div>

        <div>
          <label for="regCedula" class="block text-xs font-semibold mb-2 text-emerald-800 dark:text-emerald-200">
            C√©dula *
          </label>
          <input 
            type="text" 
            id="regCedula" 
            placeholder="Ej: 123456789" 
            required
            class="w-full px-4 py-3 rounded-lg bg-slate-50 dark:bg-slate-950/80 border border-slate-300 dark:border-slate-700 text-sm focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition"
          />
          <span id="regCedulaError" class="error-message text-red-500 text-xs mt-1"></span>
        </div>

        <div>
          <label for="regPassword" class="block text-xs font-semibold mb-2 text-emerald-800 dark:text-emerald-200">
            Contrase√±a *
          </label>
          <input 
            type="password" 
            id="regPassword" 
            placeholder="M√≠nimo 6 caracteres" 
            required
            class="w-full px-4 py-3 rounded-lg bg-slate-50 dark:bg-slate-950/80 border border-slate-300 dark:border-slate-700 text-sm focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition"
          />
          <span id="regPasswordError" class="error-message text-red-500 text-xs mt-1"></span>
        </div>

        <button 
          type="submit" 
          class="w-full py-3 rounded-full bg-emerald-500 text-slate-950 text-sm font-bold hover:bg-emerald-400 transition shadow-lg shadow-emerald-500/40 hover:transform hover:-translate-y-0.5"
        >
          Registrarse
        </button>

        <p class="text-xs text-center text-emerald-700/80 dark:text-emerald-200/70">
          ¬øYa tienes cuenta? <button type="button" onclick="document.getElementById('btnLogin').click()" class="text-emerald-600 dark:text-emerald-400 font-semibold hover:underline">Inicia sesi√≥n aqu√≠</button>
        </p>
      </form>

      <!-- INFORMACI√ìN DEL USUARIO (despu√©s de login exitoso) -->
      <div id="userInfo" class="user-info space-y-3 p-4 rounded-lg bg-emerald-100 dark:bg-emerald-900/30 border border-emerald-500">
        <h3 class="text-lg font-bold text-emerald-700 dark:text-emerald-300">
          ¬°Bienvenido/a!
        </h3>
        
        <div class="space-y-2 text-sm">
          <p id="userRolDisplay" class="text-sm font-semibold text-emerald-600 dark:text-emerald-400"></p>
          
          <p class="text-emerald-800 dark:text-emerald-200">
            <strong>Usuario:</strong> <span id="userNameDisplay"></span>
          </p>
          <p class="text-emerald-800 dark:text-emerald-200">
            <strong>Email:</strong> <span id="userEmailDisplay"></span>
          </p>
          <p class="text-emerald-800 dark:text-emerald-200">
            <strong>C√©dula:</strong> <span id="userCedulaDisplay"></span>
          </p>
          <p class="text-emerald-800 dark:text-emerald-200">
            <strong>Nivel:</strong> <span id="userLevelDisplay"></span>
          </p>
          <p class="text-emerald-800 dark:text-emerald-200">
            <strong>Puntos Totales:</strong> <span id="userTotalPointsDisplay"></span>
          </p>
          <p class="text-emerald-800 dark:text-emerald-200">
            <strong>Puntos Actuales:</strong> <span id="userCurrentPointsDisplay"></span>
          </p>
        </div>

        <button 
          id="btnLogout" 
          type="button" 
          class="w-full py-2.5 rounded-full bg-red-500 text-white text-sm font-bold hover:bg-red-600 transition shadow-lg hover:transform hover:-translate-y-0.5"
        >
          Cerrar Sesi√≥n
        </button>
      </div>

    </div>
  </div>

  <!-- Nota informativa -->
  <p class="text-xs text-center text-emerald-700/80 dark:text-emerald-200/70 mt-4">
    Este acceso est√° destinado a estudiantes y administradores de la universidad.
  </p>
</div>

<!-- Scripts -->
<script>
// ===== TOGGLE DE TEMA =====
const themeToggle = document.getElementById('theme-toggle');
const themeToggleLight = document.getElementById('theme-toggle-light');
const themeToggleDark = document.getElementById('theme-toggle-dark');

themeToggle?.addEventListener('click', () => {
  document.documentElement.classList.toggle('dark');
  const isDark = document.documentElement.classList.contains('dark');
  
  // Actualizar iconos
  if (isDark) {
    themeToggleLight.classList.remove('hidden');
    themeToggleDark.classList.add('hidden');
  } else {
    themeToggleLight.classList.add('hidden');
    themeToggleDark.classList.remove('hidden');
  }
  
  localStorage.setItem('theme', isDark ? 'dark' : 'light');
});

// Cargar tema guardado
if (localStorage.getItem('theme') === 'dark') {
  document.documentElement.classList.add('dark');
  themeToggleLight.classList.remove('hidden');
  themeToggleDark.classList.add('hidden');
}
</script>

<!-- Script de sesi√≥n (debe ir ANTES de autenticacion.js) -->
<script src="js/sesion.js"></script>

<!-- Script de autenticaci√≥n existente -->
<script src="js/autenticacion.js"></script>

</body>
</html>