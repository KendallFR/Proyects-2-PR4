<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Blog / Publicaciones - EcoCampusCR</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="css/sky.css">

  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Font Awesome para iconos sociales -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  
  <!-- Google Material Symbols -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />



  <!-- Configuraci√≥n: modo oscuro por clase -->
  <script>
    tailwind.config = { darkMode: 'class' }
  </script>

  <style>
    /* Ajustes espec√≠ficos del feed */
    .post-img { height: 220px; object-fit: cover; }
    .ad-img { height: 120px; object-fit: cover; }
    .scrollbar-thin::-webkit-scrollbar { height: 8px; width: 8px; }
    .scrollbar-thin::-webkit-scrollbar-thumb { background: rgba(0,0,0,0.15); border-radius: 6px; }

    /* Mantener contraste del modal en dark */
    .modal-card { background: #fff; }
    .dark .modal-card { background: #0f1720; }
  </style>
</head>
<body class="bg-white text-slate-900 dark:bg-slate-950 dark:text-slate-100 min-h-screen relative overflow-x-hidden">

  <!-- Fondos animados (usa sky.css) -->
  <div class="sky-layer sky-day dark:hidden">
    <div class="cloud large" style="top: 10%; left: -10%; animation-delay: 0s;"></div>
    <div class="cloud medium" style="top: 25%; left: 40%; animation-delay: 8s;"></div>
    <div class="cloud small" style="top: 50%; left: 10%; animation-delay: 15s;"></div>
    <div class="cloud medium" style="top: 65%; left: 70%; animation-delay: 22s;"></div>
  </div>

  <div class="sky-layer sky-night hidden dark:block">
    <span class="star" style="top: 5%; left: 10%; animation-delay: 0.3s;"></span>
    <span class="star" style="top: 12%; left: 55%; animation-delay: 1.2s;"></span>
    <span class="star" style="top: 22%; left: 30%; animation-delay: 2.1s;"></span>
    <span class="star" style="top: 28%; left: 80%; animation-delay: 0.9s;"></span>
    <div class="shooting-star" style="top: 25%; left: 5%; animation-delay: 0s;"></div>
    <div class="shooting-star" style="top: 60%; left: -10%; animation-delay: 2.5s;"></div>
  </div>

  <!-- Header  -->
<header class="border-b border-slate-200 dark:border-emerald-800/60 
        bg-white/70 dark:bg-slate-950/70 sticky top-0 z-20 backdrop-blur-md">
    <div class="max-w-6xl mx-auto px-4 py-2 flex items-center justify-between gap-3">

      <!-- Logo -->
      <div class="flex items-center gap-2">
        <div class="h-9 w-9 rounded-full overflow-hidden">
        <img src="img/logo.jpg" 
       alt="Logo" 
       class="h-full w-full object-cover">
</div>

        <div>
          <h1 class="text-lg font-semibold text-emerald-700 dark:text-emerald-100 leading-none">
            EcoCampus<span class="text-emerald-500">CR</span>
          </h1>
          <p class="text-[10px] text-emerald-700/70 dark:text-emerald-200/70 mt-[1px]">
            Convierte tu reciclaje en recompensas
          </p>
        </div>
      </div>

      <!-- Navegaci√≥n escritorio -->
         <nav class="hidden md:flex items-center gap-5 text-sm font-medium">
        <a href="index.html" class="hover:text-emerald-500 dark:hover:text-emerald-300">Inicio</a>
        <a href="acerca-de.html" class="hover:text-emerald-500 dark:hover:text-emerald-300">Acerca de</a>
        <a href="contacto.html" class="hover:text-emerald-500 dark:hover:text-emerald-300">Contacto</a>
        <a href="dashboard-estudiante.html" class="hover:text-emerald-500 dark:hover:text-emerald-300">Dashboard</a>
        <a href="blogs.html" class="hover:text-emerald-500 dark:hover:text-emerald-300">Publicaciones</a>
          <a href="eventos.html" class="hover:text-emerald-500 dark:hover:text-emerald-300">Eventos</a>
      </nav>


      <!-- Derecha -->
      <div class="flex items-center gap-2">

        <!-- Sesi√≥n usuario -->
        <div id="userSession" class="hidden md:flex items-center gap-2 bg-emerald-100/40 dark:bg-emerald-900/20 
               px-2.5 py-1.5 rounded-full backdrop-blur-sm border border-emerald-300/40 dark:border-emerald-700/40">

          <span id="userSessionName" class="text-sm font-semibold text-emerald-800 dark:text-emerald-100"></span>

          <span id="userSessionPoints" class="text-[11px] px-2 py-0.5 rounded-full bg-white/70 dark:bg-slate-800/70 
                     text-emerald-700 dark:text-emerald-300 font-semibold">
            üå± 0
          </span>

          <button id="btnLogoutNav" class="text-[11px] px-2.5 py-1 rounded-full bg-red-500 text-white 
                       hover:bg-red-600 transition font-semibold">
            Salir
          </button>
        </div>

        <!-- Login -->
        <div id="loginPrompt">
          <a href="autenticacion.html" class="hidden md:inline-block text-sm px-4 py-1.5 rounded-full bg-emerald-500 
                  text-slate-950 font-semibold hover:bg-emerald-400 transition">
            Iniciar Sesi√≥n
          </a>
        </div>

        <!-- Bot√≥n tema -->
        <button id="theme-toggle" class="p-2 rounded-full border border-slate-300 dark:border-slate-600 
                     hover:bg-slate-100 dark:hover:bg-slate-800 transition">
          <span id="theme-toggle-light" class="hidden">‚òÄÔ∏è</span>
          <span id="theme-toggle-dark">üåô</span>
        </button>

        <!-- Hamburguesa -->
        <button id="menu-toggle" class="md:hidden p-2 rounded-full border border-slate-300 dark:border-slate-600 
                     hover:bg-slate-100 dark:hover:bg-slate-800 transition text-lg">
          ‚ò∞
        </button>

      </div>
    </div>

    <!-- Men√∫ m√≥vil -->
    <div id="mobile-menu" class="md:hidden hidden border-t border-slate-200 dark:border-emerald-800/60 
              bg-white/95 dark:bg-slate-950/95 shadow-lg">

      <div id="userSessionMobile" class="hidden flex-col gap-2 px-4 py-3 bg-emerald-100/40 dark:bg-emerald-900/20 
              border-b border-emerald-300/40 dark:border-emerald-700/40">

        <div class="flex items-center justify-between">
          <div class="flex items-center gap-2">
            <span id="userSessionNameMobile"
              class="text-sm font-semibold text-emerald-800 dark:text-emerald-100"></span>
            <span id="userSessionPointsMobile" class="text-xs px-2 py-0.5 rounded-full bg-white/70 dark:bg-slate-800/70 
                     text-emerald-700 dark:text-emerald-300 font-semibold">
              üå± 0
            </span>
          </div>

          <button id="btnLogoutNavMobile" class="text-xs px-3 py-1.5 rounded-full bg-red-500 text-white 
                     hover:bg-red-600 transition font-semibold">
            Salir
          </button>
        </div>
      </div>

   <nav class="px-4 py-3 flex flex-col gap-2 text-sm">
        <a href="index.html" class="hover:text-emerald-500 dark:hover:text-emerald-300">Inicio</a>
        <a href="acerca-de.html" class="hover:text-emerald-500 dark:hover:text-emerald-300">Acerca de</a>
        <a href="contacto.html" class="hover:text-emerald-500 dark:hover:text-emerald-300">Contacto</a>
        <a href="dashboard-estudiante.html" class="hover:text-emerald-500 dark:hover:text-emerald-300">Dashboard</a>
        <a href="blogs.html" class="hover:text-emerald-500 dark:hover:text-emerald-300">Publicaciones</a>
          <a href="eventos.html" class="hover:text-emerald-500 dark:hover:text-emerald-300">Eventos</a>

        <a href="autenticacion.html" id="loginPromptMobile" class="mt-2 text-center text-sm px-4 py-2 rounded-full border border-emerald-500 
                text-emerald-700 dark:text-emerald-300 hover:bg-emerald-500/10 transition">
          Iniciar sesi√≥n
        </a>
      </nav>
    </div>
  </header>

  <!-- Layout: feed + sidebar -->
  <main class="max-w-6xl mx-auto px-4 py-8 grid grid-cols-1 md:grid-cols-3 gap-8 relative z-10">
    <!-- Feed (columna principal) -->
    <section class="md:col-span-2 space-y-6">
      <!-- Crear publicaci√≥n -->
      <div class="bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-2xl p-4">
        <div class="flex items-start gap-3">
          <img src="img/imageAVAD-removebg-preview (2).png" alt="avatar" class="w-14 h-14 rounded-full object-cover"/>
          <div class="flex-1">
            <textarea id="newPostText" rows="3" placeholder="¬øQu√© hay de nuevo?" class="w-full resize-none rounded-md p-3 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 focus:outline-none"></textarea>
            <div class="flex items-center justify-between mt-3">
              <div class="text-xs text-slate-500">Comparte una noticia, foto o evento</div>
              <div>
                <button id="publishBtn" class="px-4 py-2 bg-emerald-500 text-white rounded-full text-sm hover:bg-emerald-400">Publicar</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Lista de posts (se renderiza por JS) -->
      <div id="postsContainer" class="space-y-6"></div>
    </section>

    <!-- Sidebar publicidad -->
    <aside class="space-y-6">
      <div class="sticky top-20 space-y-4">
        <div class="flex items-center justify-between">
          <h2 class="text-lg font-semibold text-emerald-700">Publicidad</h2>
          <span class="text-sm text-slate-500">Eventos</span>
        </div>

        <!-- Ads list -->
        <div id="adsContainer" class="space-y-4"></div>

        <!-- Ver todas -->
        <a href="eventos.html" class="block text-center px-4 py-2 rounded-full border border-emerald-500 text-emerald-700 hover:bg-emerald-500/10">Ver todas las actividades</a>


            <!-- Destacados -->
      <div class="bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-2xl p-4">
        <h3 class="font-semibold mb-2">Destacados</h3>
        <ul class="text-sm space-y-2">
          <li class="text-emerald-600">‚Ä¢ Campa√±a Basura Cero - 12 dic</li>
          <li class="text-emerald-600">‚Ä¢ Intercambio de libros - 18 dic</li>
          <li class="text-emerald-600">‚Ä¢ Jornada de siembra - 02 ene</li>
        </ul>
      </div>

      </div>

  
    </aside>
  </main>

  <!-- Modal publicidad -->

<div id="adModal" class="fixed inset-0 hidden bg-black/60 z-50 px-4" aria-hidden="true">
  <div class="ad-modal-wrapper">
    <div class="modal-inner modal-card bg-white dark:bg-slate-900 rounded-2xl max-w-3xl w-full p-6 border border-slate-200 dark:border-emerald-800/40">
      <button id="closeAdModal" class="text-slate-400 hover:text-slate-600 float-right text-2xl">&times;</button>
      <div id="adModalContent" class="mt-4"></div>
    </div>
  </div>
</div>

  <!-- FOOTER -->
  <footer
    class="bg-emerald-50/50 dark:bg-gradient-to-b dark:from-slate-900 dark:to-black border-t border-emerald-200/60 dark:border-emerald-800/60 text-emerald-900 dark:text-white mt-16">
    <div class="max-w-6xl mx-auto px-4 py-12">
      <!-- Grid principal del footer -->
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 mb-8">

        <!-- Secci√≥n 1: Informaci√≥n de la empresa -->
        <div class="space-y-4">
          <h3 class="text-emerald-700 dark:text-yellow-300 font-bold text-lg mb-4">EcoCampus CR</h3>
          <p class="text-sm text-emerald-800/90 dark:text-emerald-100/90 leading-relaxed">
            Plataforma de gamificaci√≥n para el reciclaje universitario. Convierte tus acciones ambientales en
            recompensas reales.
          </p>
          <p class="text-sm text-emerald-700/80 dark:text-emerald-100/80 flex items-center gap-2">
            <span class="material-symbols-outlined text-base">eco</span>
            Cuida el campus, cuida el planeta
          </p>
        </div>

        <!-- Secci√≥n 2: Enlaces r√°pidos -->
        <div class="space-y-4">
          <h3 class="text-emerald-700 dark:text-yellow-300 font-bold text-lg mb-4">Enlaces R√°pidos</h3>
          <div class="flex flex-col gap-2">
            <a href="index.html"
              class="text-sm text-emerald-800/90 dark:text-emerald-100/90 hover:text-emerald-600 dark:hover:text-yellow-300 transition-colors">Inicio</a>
            <a href="acerca-de.html"
              class="text-sm text-emerald-800/90 dark:text-emerald-100/90 hover:text-emerald-600 dark:hover:text-yellow-300 transition-colors">Acerca
              de</a>
            <a href="dashboard-estudiante.html"
              class="text-sm text-emerald-800/90 dark:text-emerald-100/90 hover:text-emerald-600 dark:hover:text-yellow-300 transition-colors">Publicaciones</a>
            <a href="contacto.html"
              class="text-sm text-emerald-800/90 dark:text-emerald-100/90 hover:text-emerald-600 dark:hover:text-yellow-300 transition-colors">Contacto</a>
          </div>
        </div>

        <!-- Secci√≥n 3: Informaci√≥n de contacto -->
        <div class="space-y-4">
          <h3 class="text-emerald-700 dark:text-yellow-300 font-bold text-lg mb-4">Contacto</h3>
          <div class="space-y-3">
            <p class="text-sm text-emerald-800/90 dark:text-emerald-100/90 flex items-start gap-2">
              <span class="material-symbols-outlined text-base mt-0.5">mail</span>
              <span>info@ecopuntos.edu</span>
            </p>
            <p class="text-sm text-emerald-800/90 dark:text-emerald-100/90 flex items-start gap-2">
              <span class="material-symbols-outlined text-base mt-0.5">phone</span>
              <span>+506 2511-1111</span>
            </p>
            <p class="text-sm text-emerald-800/90 dark:text-emerald-100/90 flex items-start gap-2">
              <span class="material-symbols-outlined text-base mt-0.5">location_on</span>
              <span>Universidad T√©cnica Nacional, Alajuela, Costa Rica</span>
            </p>
          </div>
        </div>

        <!-- Secci√≥n 4: Redes sociales -->
        <div class="space-y-4">
          <h3 class="text-emerald-700 dark:text-yellow-300 font-bold text-lg mb-4">S√≠guenos</h3>
          <div class="flex gap-3">
            <a href="https://www.facebook.com/?locale=es_LA" aria-label="Facebook"
              class="w-11 h-11 rounded-full bg-emerald-200/50 dark:bg-white/10 hover:bg-blue-600 text-emerald-900 dark:text-white hover:text-white flex items-center justify-center transition-all duration-300 hover:scale-110 hover:shadow-lg">
              <i class="fab fa-facebook-f text-lg"></i>
            </a>
            <a href="https://www.instagram.com/" aria-label="Instagram"
              class="w-11 h-11 rounded-full bg-emerald-200/50 dark:bg-white/10 hover:bg-gradient-to-br hover:from-purple-600 hover:via-pink-600 hover:to-orange-500 text-emerald-900 dark:text-white hover:text-white flex items-center justify-center transition-all duration-300 hover:scale-110 hover:shadow-lg">
              <i class="fab fa-instagram text-lg"></i>
            </a>
            <a href="https://X.com/" aria-label="X (Twitter)"
              class="w-11 h-11 rounded-full bg-emerald-200/50 dark:bg-white/10 hover:bg-black text-emerald-900 dark:text-white hover:text-white flex items-center justify-center transition-all duration-300 hover:scale-110 hover:shadow-lg">
              <i class="fab fa-x-twitter text-lg"></i>
            </a>
          </div>
        </div>
      </div>

      <!-- L√≠nea divisoria -->
      <div class="border-t border-emerald-300/40 dark:border-white/20 pt-6">
        <p class="text-center text-sm text-emerald-700/70 dark:text-emerald-100/70">
          &copy; 2025 EcoCampus CR | Proyecto acad√©mico de gamificaci√≥n ambiental | Todos los derechos reservados
        </p>
      </div>
    </div>
  </footer>

  <!-- Scripts externos (usa los tuyos) -->
  <script src="js/theme.js"></script>
  <script src="js/sesion.js"></script>
  <script src="js/sesion-navbar.js"></script>

  <!-- Feed + Ads JS (usa tu estilo/colores) -->
  <script>
    // ======== Datos de ejemplo (puedes cargar din√°micamente desde tu backend o JSON) ========
    const samplePosts = [
      {
        id: 'p1',
        author: 'Mar√≠a L√≥pez',
        avatar: 'img/mujer.jpg',
        time: 'Hace 2 hrs',
        text: 'Hoy recolectamos 120kg de residuos org√°nicos en la plaza central. ¬°Gracias a todxs!',
        img: 'img/planta.jpg',
        likes: 12,
        comments: [{by: 'Carlos', text: 'Excelente trabajo!'}]
      },
      {
        id: 'p2',
        author: 'Sistema EcoCampus',
        avatar: 'img/logo.jpg',
        time: 'Ayer',
        text: 'Pr√≥xima jornada de siembra este s√°bado. Inscr√≠bete en el anuncio a la derecha.',
        img: '',
        likes: 7,
        comments: []
      }
    ];

const sampleAds = [
  {
    id: 'a1',
    img: 'img/siembra.jpg',
    title: 'Jornada de Siembra - Sede Central',
    desc: '√önete a la jornada de reforestaci√≥n. Certificado y puntos por participaci√≥n.',
    pts: 200,
    date: 's√°bado, 12 de diciembre de 2025 ¬∑ 08:00 - 11:00',
    place: 'Sede Central',
    capacity: { used: 120, total: 200 },
    form: 'https://forms.gle/tu-form-de-ejemplo-1'
  },
  {
    id: 'a2',
    img: 'img/fondo.png',
    title: 'Taller: Compostaje dom√©stico',
    desc: 'Aprende a compostar en tu casa ‚Äî cupos limitados.',
    pts: 150,
    date: 'viernes, 20 de diciembre de 2025 ¬∑ 09:00 - 12:00',
    place: 'Auditorio Verde',
    capacity: { used: 40, total: 100 },
    form: 'https://forms.gle/tu-form-de-ejemplo-2'
  }
];


    // ======== RENDER ========
    const postsContainer = document.getElementById('postsContainer');
    const adsContainer = document.getElementById('adsContainer');
    const adModal = document.getElementById('adModal');
    const adModalContent = document.getElementById('adModalContent');
    const closeAdModal = document.getElementById('closeAdModal');

    function escapeHtml(str = '') {
      return String(str).replaceAll('&','&amp;').replaceAll('<','&lt;').replaceAll('>','&gt;').replaceAll('"','&quot;').replaceAll("'",'&#039;');
    }

    function renderAds() {
  adsContainer.innerHTML = '';
  sampleAds.forEach(ad => {
    const card = document.createElement('div');
    card.className = 'bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl overflow-hidden';

    card.innerHTML = `
      <img src="${ad.img}" alt="${escapeHtml(ad.title)}" class="w-full ad-img"/>

      <div class="p-3">
        <h4 class="font-semibold text-emerald-700 mb-1">${escapeHtml(ad.title)}</h4>

        <p class="text-sm text-emerald-600 font-semibold mb-1">${ad.pts} pts</p>

        <p class="text-xs text-slate-600 dark:text-slate-300 mb-1">
          üìÖ ${escapeHtml(ad.date)}
        </p>

        <p class="text-xs text-slate-600 dark:text-slate-300 mb-1">
          üìç ${escapeHtml(ad.place)}
        </p>

        <p class="text-xs text-slate-600 dark:text-slate-300 mb-3">
          üë• ${ad.capacity.used} cupos disponibles de ${ad.capacity.total}
        </p>

        <p class="text-sm text-slate-700 dark:text-slate-300 mb-3">${escapeHtml(ad.desc)}</p>

        <div class="flex gap-2">
          <button data-ad-id="${ad.id}" 
            class="see-more flex-1 px-3 py-2 rounded-md border border-slate-200 dark:border-slate-700 text-sm">
            Ver m√°s
          </button>

          <a href="${ad.form}" target="_blank" 
            class="join-btn flex-1 px-3 py-2 rounded-md bg-emerald-500 text-white text-center text-sm hover:bg-emerald-400">
            Unirse
          </a>
        </div>
      </div>
    `;

    adsContainer.appendChild(card);
  });

  document.querySelectorAll('.see-more').forEach(btn => {
    btn.addEventListener('click', (e) => {
      const id = e.currentTarget.getAttribute('data-ad-id');
      const ad = sampleAds.find(a => a.id === id);
      if (ad) openAdModal(ad);
    });
  });
}


function openAdModal(ad) {
  adModalContent.innerHTML = `
    <img src="${ad.img}" class="modal-img mb-4" alt="${escapeHtml(ad.title)}"/>
    <h3 class="text-2xl font-semibold text-emerald-700 mb-2">${escapeHtml(ad.title)}</h3>
    <p class="text-lg text-emerald-500 font-bold mb-2">${ad.pts} pts</p>
    <p class="text-sm mb-2 text-slate-700 dark:text-slate-300">üìÖ ${escapeHtml(ad.date)}</p>
    <p class="text-sm mb-2 text-slate-700 dark:text-slate-300">üìç ${escapeHtml(ad.place)}</p>
    <p class="text-sm mb-4 text-slate-700 dark:text-slate-300">üë• ${ad.capacity.used} cupos disponibles de ${ad.capacity.total}</p>
    <p class="text-sm mb-4 text-slate-700 dark:text-slate-300 leading-relaxed">${escapeHtml(ad.desc)}</p>
    <a href="${ad.form}" target="_blank" class="w-full inline-block text-center px-4 py-3 rounded-full bg-emerald-500 text-white font-semibold">Unirse</a>
  `;
  // mostrar overlay y bloquear scroll del body
  document.getElementById('adModal').classList.add('show');
  document.body.classList.add('no-scroll');
}

// cerrar modal (usa estas dos funciones para consistencia)
function closeAdModalFn() {
  document.getElementById('adModal').classList.remove('show');
  document.body.classList.remove('no-scroll');
  adModalContent.innerHTML = '';
}

// listeners de cierre
closeAdModal?.addEventListener('click', closeAdModalFn);
document.getElementById('adModal').addEventListener('click', (e) => {
  // si hace click fuera del modal-inner, se cierra
  if (e.target === document.getElementById('adModal') || e.target.classList.contains('ad-modal-wrapper')) {
    closeAdModalFn();
  }
});





    function renderPosts() {
      postsContainer.innerHTML = '';
      (window.posts = samplePosts).forEach(post => {
        const div = document.createElement('article');
        div.className = 'bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-2xl p-4';
        div.innerHTML = `
          <div class="flex gap-3">
            <img src="${post.avatar}" alt="${escapeHtml(post.author)}" class="w-12 h-12 rounded-full object-cover" />
            <div class="flex-1">
              <div class="flex items-center justify-between">
                <div>
                  <div class="font-semibold">${escapeHtml(post.author)}</div>
                  <div class="text-xs text-slate-500">${escapeHtml(post.time)}</div>
                </div>
                <div></div>
              </div>

              <p class="mt-3 text-sm text-slate-700 dark:text-slate-300">${escapeHtml(post.text)}</p>

              ${post.img ? `<img src="${post.img}" alt="" class="mt-3 rounded-md w-full post-img">` : ''}

              <!-- actions -->
              <div class="mt-3 flex items-center gap-4">
                <button data-post-id="${post.id}" class="like-btn inline-flex items-center gap-2 text-sm px-3 py-1 rounded-md hover:bg-slate-100 dark:hover:bg-slate-700">‚ù§Ô∏è <span class="like-count">${post.likes}</span></button>

                <button data-post-id="${post.id}" class="comment-toggle-btn inline-flex items-center gap-2 text-sm px-3 py-1 rounded-md hover:bg-slate-100 dark:hover:bg-slate-700">üí¨ <span class="comment-count">${post.comments.length}</span></button>
              </div>

              <!-- comments -->
              <div class="comments-area mt-3 hidden">
                <div class="existing-comments space-y-2 mb-3"></div>
                <div class="flex gap-2">
                  <input type="text" class="flex-1 px-3 py-2 rounded-md bg-slate-100 dark:bg-slate-900 border border-slate-200 dark:border-slate-700" placeholder="Escribe un comentario..."/>
                  <button class="post-comment-btn px-3 py-2 rounded-md bg-emerald-500 text-white">Comentar</button>
                </div>
              </div>
            </div>
          </div>
        `;
        postsContainer.appendChild(div);
      });

      // likes
      document.querySelectorAll('.like-btn').forEach(btn => {
        btn.addEventListener('click', () => {
          const pid = btn.getAttribute('data-post-id');
          const p = samplePosts.find(x => x.id === pid);
          if (p) {
            p._liked = !p._liked;
            p.likes += p._liked ? 1 : -1;
            btn.querySelector('.like-count').textContent = p.likes;
            btn.style.opacity = p._liked ? '0.9' : '1';
          }
        });
      });

      // toggle comments
      document.querySelectorAll('.comment-toggle-btn').forEach(btn => {
        btn.addEventListener('click', () => {
          const pid = btn.getAttribute('data-post-id');
          const postEl = btn.closest('article');
          const area = postEl.querySelector('.comments-area');
          area.classList.toggle('hidden');
          renderComments(pid, postEl);
        });
      });

      // post comment
      document.querySelectorAll('.post-comment-btn').forEach((btn) => {
        btn.addEventListener('click', () => {
          const postEl = btn.closest('article');
          const input = postEl.querySelector('input');
          const pid = postEl.querySelector('.like-btn').getAttribute('data-post-id');
          if (!input.value.trim()) return;
          const p = samplePosts.find(x => x.id === pid);
          p.comments.push({ by: 'T√∫', text: input.value.trim() });
          input.value = '';
          renderComments(pid, postEl);
          postEl.querySelector('.comment-count').textContent = p.comments.length;
        });
      });
    }

    function renderComments(pid, postEl) {
      const p = samplePosts.find(x => x.id === pid);
      const container = postEl.querySelector('.existing-comments');
      container.innerHTML = '';
      p.comments.forEach(c => {
        const item = document.createElement('div');
        item.className = 'bg-slate-100 dark:bg-slate-900 p-2 rounded-md text-sm';
        item.innerHTML = `<strong class="text-emerald-700 mr-2">${escapeHtml(c.by)}:</strong> ${escapeHtml(c.text)}`;
        container.appendChild(item);
      });
    }

    // publicar nuevo post (local)
    document.getElementById('publishBtn').addEventListener('click', () => {
      const text = document.getElementById('newPostText').value.trim();
      if (!text) return alert('Escribe algo para publicar');
      const newPost = {
        id: 'p' + (Math.random()*100000|0),
        author: 'T√∫',
        avatar: 'https://via.placeholder.com/120',
        time: 'Ahora',
        text,
        img: '',
        likes: 0,
        comments: []
      };
      samplePosts.unshift(newPost);
      document.getElementById('newPostText').value = '';
      renderPosts();
    });

    // modal cerrar
    closeAdModal?.addEventListener('click', () => {
  adModal.classList.add('hidden');
  adModal.classList.remove('flex');
  document.body.classList.remove('no-scroll');
});

  adModal.addEventListener('click', (e) => {
  if (e.target === adModal) {
    adModal.classList.add('hidden');
    adModal.classList.remove('flex');
    document.body.classList.remove('no-scroll');
  }
});


    // init
    renderAds();
    renderPosts();

    // Mobile menu toggle (header)
    const menuToggle = document.getElementById('menu-toggle');
    const mobileMenu = document.getElementById('mobile-menu');
    if (menuToggle && mobileMenu) {
      menuToggle.addEventListener('click', () => mobileMenu.classList.toggle('hidden'));
      mobileMenu.querySelectorAll('a').forEach(link => link.addEventListener('click', () => mobileMenu.classList.add('hidden')));
    }

    
  </script>
</body>
</html>